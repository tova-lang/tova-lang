import{_ as e,o as a,c as i,ag as n}from"./chunks/framework.DEqXEGcv.js";const k=JSON.parse('{"title":"Dev Server","description":"","frontmatter":{"title":"Dev Server"},"headers":[],"relativePath":"tooling/dev-server.md","filePath":"tooling/dev-server.md"}'),t={name:"tooling/dev-server.md"};function l(r,s,p,h,o,d){return a(),i("div",null,[...s[0]||(s[0]=[n(`<h1 id="dev-server" tabindex="-1">Dev Server <a class="header-anchor" href="#dev-server" aria-label="Permalink to &quot;Dev Server&quot;">​</a></h1><p>The Lux dev server provides a full development environment with automatic compilation, server process management, and live reloading on file changes.</p><h2 id="starting-the-dev-server" tabindex="-1">Starting the Dev Server <a class="header-anchor" href="#starting-the-dev-server" aria-label="Permalink to &quot;Starting the Dev Server&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">              # Current directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # Specify source directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8080</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Custom port</span></span></code></pre></div><h2 id="what-it-does" tabindex="-1">What It Does <a class="header-anchor" href="#what-it-does" aria-label="Permalink to &quot;What It Does&quot;">​</a></h2><p>When you run <code>lux dev</code>, the following happens:</p><ol><li><strong>Compiles</strong> all <code>.lux</code> files in the target directory to <code>.lux-out/</code></li><li><strong>Copies</strong> runtime files (reactivity, RPC, router) to <code>.lux-out/runtime/</code></li><li><strong>Generates</strong> client HTML with inlined reactive runtime</li><li><strong>Starts</strong> server processes for each server block</li><li><strong>Watches</strong> for file changes and auto-rebuilds</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  Lux dev server starting...</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Compiled 1 file(s)</span></span>
<span class="line"><span>  Output: .lux-out/</span></span>
<span class="line"><span>  Starting server on port 3000</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  1 server process(es) running</span></span>
<span class="line"><span>    -&gt; server: http://localhost:3000</span></span>
<span class="line"><span>  Client: .lux-out/index.html</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  Watching for changes. Press Ctrl+C to stop</span></span></code></pre></div><h2 id="client-html-generation" tabindex="-1">Client HTML Generation <a class="header-anchor" href="#client-html-generation" aria-label="Permalink to &quot;Client HTML Generation&quot;">​</a></h2><p>The dev server generates an <code>index.html</code> that inlines the Lux reactive runtime directly into the page, avoiding any module loading overhead during development. This includes:</p><ul><li>The <strong>reactivity runtime</strong> (<code>state</code>, <code>computed</code>, <code>effect</code>, component rendering)</li><li>The <strong>RPC runtime</strong> (client-to-server function calls)</li><li>Your <strong>compiled client code</strong></li></ul><p>The generated HTML is served at the root route <code>/</code> by the server.</p><h2 id="server-processes" tabindex="-1">Server Processes <a class="header-anchor" href="#server-processes" aria-label="Permalink to &quot;Server Processes&quot;">​</a></h2><p>Each server block in your <code>.lux</code> files runs as a separate Bun process:</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  route</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/api/users&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> list_users</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>This starts a single server on port 3000 (the default).</p><h3 id="multiple-server-blocks" tabindex="-1">Multiple Server Blocks <a class="header-anchor" href="#multiple-server-blocks" aria-label="Permalink to &quot;Multiple Server Blocks&quot;">​</a></h3><p>Named server blocks each get their own process and port:</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  route</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GET</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/api/users&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> list_users</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;events&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // WebSocket/SSE server</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  Starting server:api on port 3000</span></span>
<span class="line"><span>  Starting server:events on port 3001</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  2 server process(es) running</span></span>
<span class="line"><span>    -&gt; server:api: http://localhost:3000</span></span>
<span class="line"><span>    -&gt; server:events: http://localhost:3001</span></span></code></pre></div><p>Ports increment automatically from the base port. You can also configure them via environment variables:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PORT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PORT_EVENTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">4000</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span></span></code></pre></div><h2 id="file-watching" tabindex="-1">File Watching <a class="header-anchor" href="#file-watching" aria-label="Permalink to &quot;File Watching&quot;">​</a></h2><p>The dev server watches the source directory for changes to <code>.lux</code> files. When a change is detected:</p><ol><li>A short debounce period ensures multiple rapid saves are batched</li><li>All <code>.lux</code> files are recompiled</li><li>If compilation succeeds, old server processes are gracefully terminated (SIGTERM, with SIGKILL escalation after 2 seconds)</li><li>New server processes are spawned with the updated code</li><li>If compilation fails, the error is reported and old processes continue running</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  Rebuilding...</span></span>
<span class="line"><span>  Rebuild complete</span></span></code></pre></div><p>This means your application stays available even if a save introduces a syntax error.</p><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Option</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>--port</code></td><td><code>3000</code></td><td>Base port for server processes</td></tr><tr><td><code>--debug</code></td><td>off</td><td>Verbose error output</td></tr></tbody></table><h3 id="environment-variables" tabindex="-1">Environment Variables <a class="header-anchor" href="#environment-variables" aria-label="Permalink to &quot;Environment Variables&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td><code>PORT</code></td><td>Override the default server port</td></tr><tr><td><code>PORT_&lt;NAME&gt;</code></td><td>Override the port for a named server block</td></tr></tbody></table><h2 id="graceful-shutdown" tabindex="-1">Graceful Shutdown <a class="header-anchor" href="#graceful-shutdown" aria-label="Permalink to &quot;Graceful Shutdown&quot;">​</a></h2><p>Press <code>Ctrl+C</code> to stop the dev server. This:</p><ol><li>Closes the file watcher</li><li>Sends SIGTERM to all server processes</li><li>Exits cleanly</li></ol><h2 id="typical-workflow" tabindex="-1">Typical Workflow <a class="header-anchor" href="#typical-workflow" aria-label="Permalink to &quot;Typical Workflow&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. Create a new project</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> new</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-app</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-app</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. Install dependencies</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bun</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. Start development</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. Open in browser</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:3000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. Edit src/app.lux -- changes apply automatically</span></span></code></pre></div>`,36)])])}const g=e(t,[["render",l]]);export{k as __pageData,g as default};
