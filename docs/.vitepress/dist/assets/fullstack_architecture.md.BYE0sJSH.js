import{_ as a,o as i,c as n,ag as e}from"./chunks/framework.DEqXEGcv.js";const c=JSON.parse('{"title":"Architecture Overview","description":"","frontmatter":{},"headers":[],"relativePath":"fullstack/architecture.md","filePath":"fullstack/architecture.md"}'),t={name:"fullstack/architecture.md"};function l(p,s,h,r,k,d){return i(),n("div",null,[...s[0]||(s[0]=[e(`<h1 id="architecture-overview" tabindex="-1">Architecture Overview <a class="header-anchor" href="#architecture-overview" aria-label="Permalink to &quot;Architecture Overview&quot;">​</a></h1><p>Lux is a full-stack language where a single <code>.lux</code> file contains everything needed for both the server and the client. The compiler reads the file, splits it into separate outputs, and wires them together automatically -- including a transparent RPC bridge that lets client code call server functions as if they were local.</p><h2 id="the-three-block-model" tabindex="-1">The Three-Block Model <a class="header-anchor" href="#the-three-block-model" aria-label="Permalink to &quot;The Three-Block Model&quot;">​</a></h2><p>Every Lux application is organized into three kinds of blocks:</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">shared</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Types, validation, constants -- available to BOTH client and server</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // HTTP routes, database, auth, business logic -- runs on Bun</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Reactive state, components, UI -- runs in the browser</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>You write all three in the same file. The compiler separates them at build time.</p><h3 id="shared-block" tabindex="-1">Shared Block <a class="header-anchor" href="#shared-block" aria-label="Permalink to &quot;Shared Block&quot;">​</a></h3><p>The <code>shared</code> block defines data types, validation functions, and constants that must be identical on both sides. When the compiler processes a <code>.lux</code> file, the shared block is emitted as its own JavaScript module (e.g., <code>app.shared.js</code>) and imported by both the server and client outputs.</p><p><strong>Runtime environment:</strong> None (it is library code imported by both runtimes).</p><p>Typical contents:</p><ul><li>Type definitions (<code>type User { id: Int, name: String }</code>)</li><li>Validation functions (<code>fn validate_email(email) { ... }</code>)</li><li>Constants and enums</li><li>Shared utility functions</li></ul><h3 id="server-block" tabindex="-1">Server Block <a class="header-anchor" href="#server-block" aria-label="Permalink to &quot;Server Block&quot;">​</a></h3><p>The <code>server</code> block contains everything that runs on the server. It compiles to a standalone Bun script that starts an HTTP server via <code>Bun.serve</code>.</p><p><strong>Runtime environment:</strong> <a href="https://bun.sh" target="_blank" rel="noreferrer">Bun</a> (server-side JavaScript runtime).</p><p>Typical contents:</p><ul><li>Route declarations (<code>route GET &quot;/api/users&quot; =&gt; handler</code>)</li><li>Database configuration and models (<code>db { path: &quot;./data.db&quot; }</code>)</li><li>Server functions that become RPC endpoints</li><li>Middleware, authentication, authorization</li><li>WebSocket and SSE handlers</li><li>Background jobs and scheduled tasks</li></ul><h3 id="client-block" tabindex="-1">Client Block <a class="header-anchor" href="#client-block" aria-label="Permalink to &quot;Client Block&quot;">​</a></h3><p>The <code>client</code> block contains everything that runs in the browser. It compiles to a JavaScript module that is embedded into an HTML page along with the Lux reactive runtime.</p><p><strong>Runtime environment:</strong> Browser.</p><p>Typical contents:</p><ul><li>Reactive state (<code>state count = 0</code>)</li><li>Computed values (<code>computed total = price * quantity</code>)</li><li>Effects (<code>effect { users = server.get_users() }</code>)</li><li>Components with JSX (<code>component App { &lt;div&gt;...&lt;/div&gt; }</code>)</li><li>Event handlers and UI logic</li></ul><h2 id="how-compilation-works" tabindex="-1">How Compilation Works <a class="header-anchor" href="#how-compilation-works" aria-label="Permalink to &quot;How Compilation Works&quot;">​</a></h2><p>When you run <code>lux build</code>, the compiler performs the following steps:</p><ol><li><strong>Parse</strong> the <code>.lux</code> file into an AST</li><li><strong>Separate</strong> AST nodes by block type (shared, server, client)</li><li><strong>Generate</strong> JavaScript for each block using its specialized code generator</li><li><strong>Wire</strong> the RPC bridge -- server functions get HTTP endpoints, client code gets a <code>server</code> proxy</li><li><strong>Output</strong> separate files to the <code>.lux-out/</code> directory</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>                         lux build</span></span>
<span class="line"><span>                            |</span></span>
<span class="line"><span>                            v</span></span>
<span class="line"><span>  +---------------------------------------------------------+</span></span>
<span class="line"><span>  |                      app.lux                            |</span></span>
<span class="line"><span>  |                                                         |</span></span>
<span class="line"><span>  |  shared { types, validation }                           |</span></span>
<span class="line"><span>  |  server { routes, db, functions }                       |</span></span>
<span class="line"><span>  |  client { state, components, effects }                  |</span></span>
<span class="line"><span>  +---------------------------------------------------------+</span></span>
<span class="line"><span>                            |</span></span>
<span class="line"><span>              +-------------+-------------+</span></span>
<span class="line"><span>              |             |             |</span></span>
<span class="line"><span>              v             v             v</span></span>
<span class="line"><span>        app.shared.js  app.server.js  app.client.js</span></span>
<span class="line"><span>        (types, utils) (Bun.serve,   (reactive runtime,</span></span>
<span class="line"><span>                        RPC endpoints, signals, effects,</span></span>
<span class="line"><span>                        routes, db)    components, RPC proxy)</span></span>
<span class="line"><span>                            |             |</span></span>
<span class="line"><span>                            +------+------+</span></span>
<span class="line"><span>                                   |</span></span>
<span class="line"><span>                              index.html</span></span>
<span class="line"><span>                       (client JS + runtime inlined)</span></span></code></pre></div><p>The server output imports <code>app.shared.js</code> for type definitions. The client output also imports <code>app.shared.js</code>. Both sides have identical type definitions and validation logic without any duplication.</p><h2 id="the-rpc-bridge" tabindex="-1">The RPC Bridge <a class="header-anchor" href="#the-rpc-bridge" aria-label="Permalink to &quot;The RPC Bridge&quot;">​</a></h2><p>The most powerful part of the three-block model is the automatic RPC (Remote Procedure Call) bridge. Any function defined in a <code>server</code> block can be called from the <code>client</code> block using <code>server.function_name()</code>:</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_users() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    UserModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.all()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_user(name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    UserModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.create({ name, email })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  state users: [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  effect {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.get_users()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> handle_submit() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    new_user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.create_user(name, email)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">users, new_user]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>Under the hood, the compiler:</p><ol><li><p><strong>Server side:</strong> Generates a <code>POST /rpc/get_users</code> endpoint for each server function. The endpoint reads <code>{ __args: [...] }</code> from the request body, spreads args into the function, and returns <code>{ result: value }</code>.</p></li><li><p><strong>Client side:</strong> Creates a <code>server</code> Proxy object. When you write <code>server.get_users()</code>, the proxy intercepts the call and delegates to an async <code>rpc()</code> function that performs a <code>fetch()</code> to the corresponding endpoint.</p></li></ol><p>The result is that you write <code>server.get_users()</code> and the compiler handles all the networking, serialization, and deserialization. See <a href="./rpc.html">RPC Bridge</a> for full details.</p><h2 id="architecture-diagram" tabindex="-1">Architecture Diagram <a class="header-anchor" href="#architecture-diagram" aria-label="Permalink to &quot;Architecture Diagram&quot;">​</a></h2><p>Here is the complete picture of how a Lux application runs:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>  Browser                                    Server (Bun)</span></span>
<span class="line"><span>  ========                                   ============</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  index.html</span></span>
<span class="line"><span>    |</span></span>
<span class="line"><span>    v</span></span>
<span class="line"><span>  +--------------------------+               +---------------------------+</span></span>
<span class="line"><span>  | app.client.js            |               | app.server.js             |</span></span>
<span class="line"><span>  |                          |               |                           |</span></span>
<span class="line"><span>  | - createSignal()         |   HTTP POST   | - Bun.serve()             |</span></span>
<span class="line"><span>  | - createEffect()         | ------------&gt; | - RPC endpoints           |</span></span>
<span class="line"><span>  | - components (JSX)       |  /rpc/&lt;name&gt;  | - route handlers          |</span></span>
<span class="line"><span>  | - server.fn_name()       | &lt;------------ | - database access         |</span></span>
<span class="line"><span>  |   (via rpc() proxy)      |  { result }   | - middleware              |</span></span>
<span class="line"><span>  |                          |               |                           |</span></span>
<span class="line"><span>  | imports:                 |               | imports:                  |</span></span>
<span class="line"><span>  |   app.shared.js          |               |   app.shared.js           |</span></span>
<span class="line"><span>  |   runtime/reactivity.js  |               |                           |</span></span>
<span class="line"><span>  |   runtime/rpc.js         |               |                           |</span></span>
<span class="line"><span>  +--------------------------+               +---------------------------+</span></span>
<span class="line"><span>              |                                          |</span></span>
<span class="line"><span>              +------------------------------------------+</span></span>
<span class="line"><span>                               |</span></span>
<span class="line"><span>                         app.shared.js</span></span>
<span class="line"><span>                         (types, validation, constants)</span></span></code></pre></div><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><h3 id="keep-shared-lean" tabindex="-1">Keep Shared Lean <a class="header-anchor" href="#keep-shared-lean" aria-label="Permalink to &quot;Keep Shared Lean&quot;">​</a></h3><p>Only put data contracts and pure validation in <code>shared {}</code>. Business logic, database calls, and anything with side effects belongs in <code>server {}</code>. UI state and rendering belongs in <code>client {}</code>.</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Good: shared contains only types and validation</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">shared</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { id: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_email(email: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email.contains(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) &amp;&amp; email.length() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Bad: don&#39;t put business logic in shared</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">shared</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_user(name, email) {  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// This belongs in server {}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    UserModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.create({ name, email })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="type-your-server-functions" tabindex="-1">Type Your Server Functions <a class="header-anchor" href="#type-your-server-functions" aria-label="Permalink to &quot;Type Your Server Functions&quot;">​</a></h3><p>Adding type annotations to server function parameters enables automatic request validation. The compiler generates validation code that checks types before executing the function:</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // With types: compiler auto-validates that name is String, age is Int</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_user(name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, age: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    UserModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.create({ name, age })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>If a client sends incorrect types, the RPC endpoint returns a 400 error with validation details before the function body ever executes.</p><h3 id="shared-validation-for-both-sides" tabindex="-1">Shared Validation for Both Sides <a class="header-anchor" href="#shared-validation-for-both-sides" aria-label="Permalink to &quot;Shared Validation for Both Sides&quot;">​</a></h3><p>Put validation functions in <code>shared {}</code> so the same logic runs on both the client (for instant UX feedback) and the server (for security):</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">shared</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_email(email: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    email.contains(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) &amp;&amp; email.length() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_name(name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Bool</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name.length() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; name.length() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> handle_submit() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_email(email) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { show_error(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Invalid email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_name(name) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { show_error(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Name too short&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.create_user(name, email)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> create_user(name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, email: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> User</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_email(email) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Invalid email&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    guard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> validate_name(name) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> error(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Invalid name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) }</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    UserModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.create({ name, email })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="prefer-rpc-over-manual-routes" tabindex="-1">Prefer RPC Over Manual Routes <a class="header-anchor" href="#prefer-rpc-over-manual-routes" aria-label="Permalink to &quot;Prefer RPC Over Manual Routes&quot;">​</a></h3><p>Use <code>server.function_name()</code> from client code instead of manually fetching API endpoints. The compiler generates efficient RPC endpoints automatically and handles serialization for you.</p><div class="language-lux vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">lux</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Preferred: let the compiler handle networking</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_data() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.get_users()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Avoid: manual fetch calls bypass the RPC bridge</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> load_data() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    response </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fetch(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/api/users&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Manual -- no type safety, no auto-wiring</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    users </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> response.json()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><ul><li><a href="./shared-block.html">Shared Block</a> -- deep dive into shared types and validation</li><li><a href="./server-block.html">Server Block</a> -- routes, database, and server functions</li><li><a href="./client-block.html">Client Block</a> -- reactive UI and components</li><li><a href="./rpc.html">RPC Bridge</a> -- how the automatic RPC system works</li><li><a href="./named-blocks.html">Named Blocks</a> -- multi-server architecture</li><li><a href="./compilation.html">Compilation</a> -- build output and production optimization</li></ul>`,51)])])}const E=a(t,[["render",l]]);export{c as __pageData,E as default};
